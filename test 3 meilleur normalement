local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

-- FOND ANIMÉ DÉGRADÉ
local animatedBg = Instance.new("Frame", CoreGui)
animatedBg.Name = "AnimatedBackground"
animatedBg.ZIndex = 0
animatedBg.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
animatedBg.BorderSizePixel = 0
animatedBg.Size = UDim2.new(1, 0, 1, 0)
animatedBg.Position = UDim2.new(0, 0, 0, 0)

local gradient = Instance.new("UIGradient", animatedBg)
gradient.Rotation = 0
gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0.00, Color3.fromRGB(0, 255, 200)),
    ColorSequenceKeypoint.new(0.50, Color3.fromRGB(100, 100, 255)),
    ColorSequenceKeypoint.new(1.00, Color3.fromRGB(255, 0, 150))
}

task.spawn(function()
    while animatedBg.Parent do
        for i = 0, 360, 1 do
            gradient.Rotation = i
            task.wait(0.02)
        end
    end
end)

-- ÉCRAN DE CHARGEMENT
local loadingGui = Instance.new("ScreenGui", CoreGui)
loadingGui.Name = "PercyLoading"

local background = Instance.new("Frame", loadingGui)
background.Size = UDim2.new(1, 0, 1, 0)
background.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
background.BackgroundTransparency = 1

local loadingText = Instance.new("TextLabel", background)
loadingText.AnchorPoint = Vector2.new(0.5, 0.5)
loadingText.Position = UDim2.new(0.5, 0, 0.5, 0)
loadingText.Size = UDim2.new(0, 400, 0, 50)
loadingText.BackgroundTransparency = 1
loadingText.Font = Enum.Font.GothamBold
loadingText.Text = "Chargement de Percy le Meilleur..."
loadingText.TextScaled = true
loadingText.TextColor3 = Color3.fromRGB(0, 255, 127)
loadingText.TextTransparency = 1

TweenService:Create(background, TweenInfo.new(0.5), {BackgroundTransparency = 0}):Play()
TweenService:Create(loadingText, TweenInfo.new(0.5), {TextTransparency = 0}):Play()

task.delay(2, function()
    TweenService:Create(background, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    TweenService:Create(loadingText, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
    task.wait(0.5)
    loadingGui:Destroy()

    -- GUI PRINCIPALE
    local gui = Instance.new("ScreenGui", CoreGui)
    gui.Name = "PercyLeMeilleur_Hub"

    local main = Instance.new("Frame", gui)
    main.Size = UDim2.new(0, 300, 0, 400)
    main.Position = UDim2.new(0.02, 0, 0.5, -200)
    main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    main.ZIndex = 1
    Instance.new("UICorner", main).CornerRadius = UDim.new(0, 8)

    local layout = Instance.new("UIListLayout", main)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, 5)

    local autofarm = false
    local killaura = false
    local friendsOnly = true

    local function createButton(txt, callback)
        local btn = Instance.new("TextButton", main)
        btn.Size = UDim2.new(1, -10, 0, 40)
        btn.Position = UDim2.new(0, 5, 0, 0)
        btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        btn.Text = txt
        btn.Font = Enum.Font.Gotham
        btn.TextScaled = true
        btn.TextColor3 = Color3.new(1, 1, 1)
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
        btn.MouseButton1Click:Connect(callback)
    end

    createButton("Auto Coins [ON/OFF]", function()
        autofarm = not autofarm
    end)

    RunService.RenderStepped:Connect(function()
        if autofarm then
            for _, v in pairs(Workspace:GetDescendants()) do
                if v.Name == "Coin" and v:IsA("Part") then
                    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                    if hrp then
                        hrp.CFrame = v.CFrame + Vector3.new(0, 3, 0)
                        task.wait(0.1)
                    end
                end
            end
        end
    end)

    createButton("Kill Aura [All/Sauf amis]", function()
        killaura = not killaura
    end)

    RunService.RenderStepped:Connect(function()
        if killaura then
            for _, plr in pairs(Players:GetPlayers()) do
                if plr ~= player and plr.Character and plr.Character:FindFirstChild("Humanoid") then
                    local isFriend = Players.LocalPlayer:IsFriendsWith(plr.UserId)
                    if not friendsOnly or not isFriend then
                        plr.Character.Humanoid.Health = 0
                    end
                end
            end
        end
    end)

    createButton("Lancer Infinite Yield", function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
    end)

    createButton("Sélectionner Boss à TP", function()
        for _, obj in pairs(Workspace:GetChildren()) do
            if obj:FindFirstChild("Humanoid") and obj:FindFirstChild("HumanoidRootPart") then
                createButton("TP Boss: " .. obj.Name, function()
                    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                    if hrp then
                        hrp.CFrame = obj.HumanoidRootPart.CFrame + Vector3.new(0, 5, 0)
                    end
                end)
            end
        end
    end)

    createButton("Sélectionner Joueur à TP", function()
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= player and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                createButton("TP: " .. plr.Name, function()
                    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                    if hrp then
                        hrp.CFrame = plr.Character.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
                    end
                end)
            end
        end
    end)
end)